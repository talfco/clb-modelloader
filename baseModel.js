// Generated by CoffeeScript 1.4.0
(function() {
  var BaseModel, mongoose;

  mongoose = require("mongoose");

  module.exports = BaseModel = (function() {

    function BaseModel(modelName, collection, schemaJSON, props) {
      this.modelName = modelName;
      this.collection = collection;
      if (props.winston !== void 0) {
        props.winston.info("BaseModel: " + this.modelName + " - " + this.collection + " - schema: ", schemaJSON);
      }
      this.schema = new mongoose.Schema(schemaJSON);
      this.dbModel = mongoose.model(this.modelName, this.schema, this.collection);
      if (props.doc !== void 0) {
        this.model = new this.dbModel(props.doc);
      } else {
        this.model = new this.dbModel();
      }
      if (props.querylimit !== void 0) {
        this.queryLimit = props.queryLimit;
      } else {
        this.queryLimit = 20;
      }
      this.schema.virtual('id').get(function() {
        return this._id;
      });
      this.schema.methods.toBackbone = function() {
        var obj;
        obj = this.toObject();
        obj.id = obj._id;
        return obj;
      };
    }

    BaseModel.prototype.getModelName = function() {
      return this.modelName;
    };

    BaseModel.prototype.getCollection = function() {
      return this.collection;
    };

    BaseModel.prototype.getDBModel = function() {
      return this.dbModel;
    };

    BaseModel.prototype.getDBSchema = function() {
      return this.schema;
    };

    BaseModel.prototype.getQueryLimit = function() {
      return this.queryLimit;
    };

    BaseModel.prototype.save = function() {
      return this.model.save();
    };

    return BaseModel;

  })();

}).call(this);
